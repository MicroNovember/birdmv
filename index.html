<!DOCTYPE html>
<html lang="th">
<head>
    <title>SAMORN Movie | ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#dc2626">
    <meta name="description" content="‡∏î‡∏π‡∏´‡∏ô‡∏±‡∏á VIP ‡∏Å‡∏±‡∏ö SAMORN Movie - ‡∏£‡∏∞‡∏ö‡∏ö VIP Login ‡∏û‡∏£‡πâ‡∏≠‡∏° PWA">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SAMORN">
    <meta name="application-name" content="SAMORN Movie">
    <meta name="msapplication-TileColor" content="#dc2626">
    <meta name="msapplication-config" content="pwa/browserconfig.xml">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="pwa/manifest.json">
    <link rel="apple-touch-icon" href="assets/icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/icons/favicon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/icons/favicon-16.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- SweetAlert2 for beautiful alerts -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <link rel="stylesheet" href="assets/css/style.css"> 
    <link rel="stylesheet" href="assets/css/menu.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <!-- Firebase Configuration -->
    <script>
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBt8BVo655fDa1YZJrLFdfiJ2eID40ei9A",
            authDomain: "samorn-mv.firebaseapp.com",
            projectId: "samorn-mv",
            storageBucket: "samorn-mv.firebasestorage.app",
            messagingSenderId: "812347002959",
            appId: "1:812347002959:web:69e39d2827308dfb571a3a",
            measurementId: "G-3DG3NS8VLF"
        };

        // Initialize Firebase (check if already initialized)
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const db = firebase.firestore();
        const auth = firebase.auth();
        
        // Make Firebase available globally
        window.db = db;
        window.auth = auth;
    </script> 
</head>
<body class="bg-gray-900 text-white font-sans">

    <header class="sticky top-0 z-40 bg-gray-900/95 backdrop-blur-md border-b border-gray-800 shadow-xl">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between h-16 md:h-20">
                
                <div class="flex-shrink-0">
                    <a href="index.html" class="flex items-center">
                        <h1 class="text-2xl md:text-3xl font-black tracking-tighter italic">
                            <span class="text-blue-500">SAMORN</span>
                            <span class="text-white">MOVIE</span>
                        </h1>
                    </a>
                </div>

                <div class="hidden md:flex items-center ml-4">
                    <form id="search-form" class="relative group" onsubmit="return false;">
                        <input type="text" id="search-input" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏ô‡∏±‡∏á..." 
                               class="w-48 lg:w-64 bg-gray-800 border border-gray-700 rounded-full py-2 px-4 pr-10 text-sm focus:outline-none focus:ring-2 focus:ring-blue-600 transition-all" 
                               oninput="searchMovies()">
                        <button type="submit" onclick="searchMovies()" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400">üîç</button>
                    </form>
                </div>

                <div class="md:hidden">
                    <button onclick="toggleSearch()" class="p-2 text-gray-400">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path>
                        </svg>
                    </button>
                </div>

            </div>
        </div>
    </header>

    <div class="flex">
        <!-- Left Sidebar Menu for Desktop -->
        <aside class="hidden lg:block w-64 bg-gray-900/95 backdrop-blur-md border-r border-gray-800 min-h-screen sticky top-20">
            <nav class="p-4 space-y-2">
                <a href="index.html" class="flex items-center px-4 py-3 rounded-lg bg-white/10 transition text-sm font-medium group">
                    <svg class="w-5 h-5 mr-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path>
                    </svg>
                    ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                </a>
                <a href="pages/category.html?cat=thai" class="flex items-center px-4 py-3 rounded-lg hover:bg-white/10 transition text-sm font-medium group">
                    <svg class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"></path>
                    </svg>
                    ‡πÑ‡∏ó‡∏¢
                </a>
                <a href="pages/category.html?cat=korea" class="flex items-center px-4 py-3 rounded-lg hover:bg-white/10 transition text-sm font-medium group">
                    <svg class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"></path>
                    </svg>
                    ‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ
                </a>
                <a href="pages/category.html?cat=china" class="flex items-center px-4 py-3 rounded-lg hover:bg-white/10 transition text-sm font-medium group">
                    <svg class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"></path>
                    </svg>
                    ‡∏à‡∏µ‡∏ô/‡∏Æ‡πà‡∏≠‡∏á‡∏Å‡∏á
                </a>
                <a href="pages/category.html?cat=inter" class="flex items-center px-4 py-3 rounded-lg hover:bg-white/10 transition text-sm font-medium group">
                    <svg class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"></path>
                    </svg>
                    ‡∏™‡∏≤‡∏Å‡∏•
                </a>
                <a href="pages/category.html?cat=cartoon" class="flex items-center px-4 py-3 rounded-lg hover:bg-white/10 transition text-sm font-medium group">
                    <svg class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"></path>
                    </svg>
                    ‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ô
                </a>
                <a href="pages/category.html?cat=india" class="flex items-center px-4 py-3 rounded-lg hover:bg-white/10 transition text-sm font-medium group">
                    <svg class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"></path>
                    </svg>
                    ‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢
                </a>
                <a href="pages/category.html?cat=asia" class="flex items-center px-4 py-3 rounded-lg hover:bg-white/10 transition text-sm font-medium group">
                    <svg class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"></path>
                    </svg>
                    ‡πÄ‡∏≠‡πÄ‡∏ã‡∏µ‡∏¢
                </a>
                <div class="border-t border-gray-700 pt-2 mt-2">
                    <div id="vip-login-btn">
                        <button onclick="showVipModal()" class="w-full flex items-center px-4 py-3 rounded-lg bg-gradient-to-r from-yellow-500 to-orange-600 hover:from-yellow-600 hover:to-orange-700 text-white transition text-sm font-medium group">
                            <svg class="w-5 h-5 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                            </svg>
                            VIP
                        </button>
                    </div>
                    <div id="vip-logout-btn" class="hidden">
                        <div class="mb-2 px-2">
                            <div id="vip-status" class="text-xs text-gray-400 text-center"></div>
                        </div>
                        <button onclick="logoutVip()" class="w-full flex items-center px-4 py-3 rounded-lg bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white transition text-sm font-medium group">
                            <svg class="w-5 h-5 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z" clip-rule="evenodd"></path>
                            </svg>
                            VIP Logout
                        </button>
                    </div>
                    <button onclick="logout()" class="w-full flex items-center px-4 py-3 rounded-lg bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700 text-white transition text-sm font-medium group">
                        <svg class="w-5 h-5 mr-3" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z" clip-rule="evenodd"></path>
                        </svg>
                        Logout All
                    </button>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 container mx-auto px-2 md:px-4 mt-6 mb-24">
            <div id="search-result-container"></div>
            
            <div id="movie-sections-container">
                <div class="flex items-center justify-center py-20">
                    <div class="animate-spin rounded-full h-10 w-10 border-t-2 border-blue-500"></div>
                </div>
            </div>
        </main>
    </div>

    <nav class="mobile-bottom-nav md:hidden fixed bottom-0 left-0 right-0 bg-gray-900/95 backdrop-blur-lg border-t border-gray-800 z-50 pb-2">
        <div class="flex justify-around items-center h-16">
            <a href="index.html" class="flex flex-col items-center p-2 text-blue-400 nav-active">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg>
                <span class="text-[10px] mt-1 font-bold">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span>
            </a>
            <button onclick="toggleMobileCategories()" class="flex flex-col items-center p-2 text-gray-400">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"></path></svg>
                <span class="text-[10px] mt-1 font-bold">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</span>
            </button>
            <button onclick="toggleSearch()" class="flex flex-col items-center p-2 text-gray-400">
                <div class="bg-gray-800 p-2 rounded-full border border-gray-700">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                </div>
            </button>
            <button onclick="showVipModal()" class="flex flex-col items-center p-2 text-yellow-500">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>
                <span class="text-[10px] mt-1 font-bold">VIP</span>
            </button>
        </div>
    </nav>

    <div id="mobile-search-overlay" class="fixed inset-0 bg-gray-900/98 z-[60] hidden transition-all">
        <div class="p-4">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-bold">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏ô‡∏±‡∏á</h3>
                <button onclick="toggleSearch()" class="text-gray-400">‚úñ</button>
            </div>
            <input type="text" id="mobile-search-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£..." 
                   class="w-full px-4 py-3 rounded-xl bg-gray-800 border border-gray-700 text-white focus:ring-2 focus:ring-blue-600" 
                   oninput="mobileSearchMovies()">
            <div id="mobile-search-result" class="mt-4"></div>
        </div>
    </div>

    <!-- Mobile Categories Overlay -->
    <div id="mobile-categories-overlay" class="fixed inset-0 bg-gray-900/98 z-[60] hidden transition-all">
        <div class="p-4">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-bold">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏´‡∏ô‡∏±‡∏á</h3>
                <button onclick="toggleMobileCategories()" class="text-gray-400">‚úñ</button>
            </div>
            <div class="grid grid-cols-2 gap-3">
                <a href="pages/category.html?cat=thai" class="bg-gray-800 hover:bg-gray-700 p-4 rounded-xl text-center transition">
                    <div class="text-2xl mb-2">üáπüá≠</div>
                    <div class="text-sm font-medium">‡πÑ‡∏ó‡∏¢</div>
                </a>
                <a href="pages/category.html?cat=korea" class="bg-gray-800 hover:bg-gray-700 p-4 rounded-xl text-center transition">
                    <div class="text-2xl mb-2">üá∞üá∑</div>
                    <div class="text-sm font-medium">‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ</div>
                </a>
                <a href="pages/category.html?cat=china" class="bg-gray-800 hover:bg-gray-700 p-4 rounded-xl text-center transition">
                    <div class="text-2xl mb-2">üá®üá≥</div>
                    <div class="text-sm font-medium">‡∏à‡∏µ‡∏ô/‡∏Æ‡πà‡∏≠‡∏á‡∏Å‡∏á</div>
                </a>
                <a href="pages/category.html?cat=inter" class="bg-gray-800 hover:bg-gray-700 p-4 rounded-xl text-center transition">
                    <div class="text-2xl mb-2">üåç</div>
                    <div class="text-sm font-medium">‡∏™‡∏≤‡∏Å‡∏•</div>
                </a>
                <a href="pages/category.html?cat=cartoon" class="bg-gray-800 hover:bg-gray-700 p-4 rounded-xl text-center transition">
                    <div class="text-2xl mb-2">üé®</div>
                    <div class="text-sm font-medium">‡∏Å‡∏≤‡∏£‡πå‡∏ï‡∏π‡∏ô</div>
                </a>
                <a href="pages/category.html?cat=india" class="bg-gray-800 hover:bg-gray-700 p-4 rounded-xl text-center transition">
                    <div class="text-2xl mb-2">üáÆüá≥</div>
                    <div class="text-sm font-medium">‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢</div>
                </a>
                <a href="pages/category.html?cat=asia" class="bg-gray-800 hover:bg-gray-700 p-4 rounded-xl text-center transition">
                    <div class="text-2xl mb-2">üèØ</div>
                    <div class="text-sm font-medium">‡πÄ‡∏≠‡πÄ‡∏ã‡∏µ‡∏¢</div>
                </a>
                <button onclick="showVipModal()" class="bg-gradient-to-r from-yellow-500 to-orange-600 hover:from-yellow-600 hover:to-orange-700 p-4 rounded-xl text-center transition">
                    <div class="text-2xl mb-2">‚≠ê</div>
                    <div class="text-sm font-medium text-white">VIP</div>
                </button>
            </div>
        </div>
    </div>

    <!-- VIP Login Modal -->
    <div id="vip-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-[70] hidden flex items-center justify-center p-4">
        <div class="bg-gray-800 rounded-2xl p-8 max-w-md w-full border border-gray-700 shadow-2xl">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
                    </svg>
                </div>
                <h2 class="text-2xl font-bold text-white mb-2">VIP Access</h2>
                <p class="text-gray-400 text-sm">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™ VIP 4 ‡∏ï‡∏±‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</p>
            </div>
            
            <div class="space-y-4">
                <div class="flex justify-center space-x-2">
                    <input type="text" maxlength="1" class="vip-input w-14 h-14 bg-gray-700 border border-gray-600 rounded-lg text-center text-2xl font-bold focus:border-red-500 focus:ring-2 focus:ring-red-500/20 transition" data-index="0">
                    <input type="text" maxlength="1" class="vip-input w-14 h-14 bg-gray-700 border border-gray-600 rounded-lg text-center text-2xl font-bold focus:border-red-500 focus:ring-2 focus:ring-red-500/20 transition" data-index="1">
                    <input type="text" maxlength="1" class="vip-input w-14 h-14 bg-gray-700 border border-gray-600 rounded-lg text-center text-2xl font-bold focus:border-red-500 focus:ring-2 focus:ring-red-500/20 transition" data-index="2">
                    <input type="text" maxlength="1" class="vip-input w-14 h-14 bg-gray-700 border border-gray-600 rounded-lg text-center text-2xl font-bold focus:border-red-500 focus:ring-2 focus:ring-red-500/20 transition" data-index="3">
                </div>
                
                <div id="vip-error" class="hidden bg-red-500/20 border border-red-500/50 rounded-lg p-3 text-red-400 text-sm text-center">
                    ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
                </div>
                
                <div class="flex space-x-3">
                    <button onclick="closeVipModal()" class="flex-1 px-4 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition font-medium">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button onclick="verifyVipCode()" class="flex-1 px-4 py-3 bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700 text-white rounded-lg transition font-medium">
                        ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                    </button>
                </div>
            </div>
            
            </div>
        </div>
    </div>

    <!-- Load Movie Data (JSON with Gzip) -->
    <!-- No need to load JS files - using JSON with fetch -->
    
    <script src="assets/js/auth-check.js"></script>
    <script src="assets/js/menu.js"></script>
    <script src="assets/js/alert2.js"></script>
    <script src="assets/js/script.js"></script>
    <script src="assets/js/vip-auth.js"></script>
    <script src="assets/js/firebase-setup.js"></script>
    <script src="assets/js/tv-detection.js"></script>
    <script src="assets/js/tv-navigation.js"></script>
    
    <!-- VIP Expiry Check -->
    <script>
        // Check VIP expiry and update menu status
        async function checkVipExpiry() {
            const vipData = localStorage.getItem('vip_access');
            const vipStatus = document.getElementById('vip-status');
            
            if (!vipData) {
                if (vipStatus) vipStatus.textContent = '';
                return;
            }
            
            try {
                const data = JSON.parse(vipData);
                if (!data.expires) {
                    if (vipStatus) vipStatus.textContent = '';
                    return;
                }
                
                let expiryDate = data.expires instanceof Date ? data.expires : new Date(data.expires);
                
                // Verify expiration date from Firebase if available
                if (window.db && data.code) {
                    try {
                        const vipDoc = await window.db.collection('vip_codes').doc(data.code).get();
                        if (vipDoc.exists) {
                            const firebaseData = vipDoc.data();
                            if (firebaseData.expires) {
                                // Handle Firebase Timestamp properly
                                if (firebaseData.expires.toDate) {
                                    expiryDate = firebaseData.expires.toDate();
                                } else {
                                    expiryDate = new Date(firebaseData.expires);
                                }
                                
                                // Validate the date before updating
                                if (!isNaN(expiryDate.getTime())) {
                                    // Update localStorage with Firebase expiration
                                    data.expires = expiryDate.toISOString();
                                    localStorage.setItem('vip_access', JSON.stringify(data));
                                } else {
                                    console.error('Invalid Firebase date:', firebaseData.expires);
                                }
                            }
                        }
                    } catch (error) {
                        console.error('Error checking Firebase expiration:', error);
                    }
                }
                
                const now = new Date();
                
                // Check if date is valid
                if (isNaN(expiryDate.getTime())) {
                    console.error('Invalid expiry date:', data.expires);
                    if (vipStatus) vipStatus.textContent = '';
                    return;
                }
                
                const daysUntilExpiry = Math.ceil((expiryDate - now) / (1000 * 60 * 60 * 24));
                
                // Debug logging
                console.error('VIP Expiry Check:', {
                    code: data.code,
                    expires: data.expires,
                    expiryDate: expiryDate.toISOString(),
                    now: now.toISOString(),
                    daysUntilExpiry: daysUntilExpiry
                });
                
                // Update VIP status in menu
                if (vipStatus) {
                    if (daysUntilExpiry <= 0) {
                        vipStatus.textContent = '‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß';
                        vipStatus.className = 'text-xs text-red-400 text-center font-medium';
                        
                        // Clear expired VIP data
                        localStorage.removeItem('vip_access');
                        localStorage.removeItem('user_type');
                        setTimeout(() => location.reload(), 3000);
                    } else if (daysUntilExpiry <= 3) {
                        const message = daysUntilExpiry === 1 
                            ? '‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ'
                            : `‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô‡∏≠‡∏µ‡∏Å ${daysUntilExpiry} ‡∏ß‡∏±‡∏ô`;
                        
                        vipStatus.textContent = message;
                        vipStatus.className = 'text-xs text-yellow-400 text-center font-medium';
                    } else {
                        const expiryDateStr = expiryDate.toLocaleDateString('th-TH', {
                            day: 'numeric',
                            month: 'short',
                            year: 'numeric'
                        });
                        vipStatus.textContent = `‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏: ${expiryDateStr}`;
                        vipStatus.className = 'text-xs text-green-400 text-center';
                    }
                }
            } catch (error) {
                console.error('Error checking VIP expiry:', error);
                if (vipStatus) vipStatus.textContent = '';
            }
        }
        
        // Check expiry on page load
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(checkVipExpiry, 2000);
        });
        
        // Check expiry every hour
        setInterval(checkVipExpiry, 60 * 60 * 1000);
    </script>
    
    <!-- PWA Registration -->
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('pwa/sw.js')
                    .then((registration) => {
                        console.error('Service Worker registered successfully:', registration);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New content is available
                                    if (confirm('‡∏°‡∏µ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà! ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.error('Service Worker registration failed:', error);
                    });
            });
        }
        
        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button
            const installBtn = document.createElement('button');
            installBtn.innerHTML = 'üì± ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏õ';
            installBtn.className = 'fixed bottom-20 right-4 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full shadow-lg z-50 transition';
            installBtn.onclick = () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.error('User accepted the install prompt');
                        } else {
                            console.error('User dismissed the install prompt');
                        }
                        deferredPrompt = null;
                        installBtn.remove();
                    });
                }
            };
            document.body.appendChild(installBtn);
        });
        
        // Hide install button when app is installed
        window.addEventListener('appinstalled', () => {
            console.error('PWA was installed');
            const installBtn = document.querySelector('button[onclick*="install"]');
            if (installBtn) installBtn.remove();
        });
    </script>
</body>
</html>